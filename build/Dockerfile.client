ARG GOLANG_IMAGE_VERSION=golang:1.20-bookworm

FROM ${GOLANG_IMAGE_VERSION} AS builder

ENV POCKET_ROOT=/go/src/github.com/pocket-network

WORKDIR $POCKET_ROOT

RUN apt-get update && apt-get install -y procps bash-completion jq
RUN echo "source /etc/bash_completion" >> ~/.bashrc
# tail -n +2 removes the first line of the completion script since the CLI spits out some logs
RUN echo "source <($POCKET_ROOT/bin/p1 completion bash | tail -n +2)" >> ~/.bashrc
